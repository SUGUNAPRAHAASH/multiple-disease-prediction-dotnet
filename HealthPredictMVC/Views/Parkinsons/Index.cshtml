@model ParkinsonsViewModel
@{
    ViewData["Title"] = "Parkinson's Screening";
}

<!-- Page Header -->
<section class="page-header">
    <div class="container">
        <div class="page-header-icon">
            <i class="fas fa-brain"></i>
        </div>
        <h1>Parkinson's Disease Screening</h1>
        <p class="mb-0" style="color: rgba(255,255,255,0.9);">
            Voice-based screening using biomedical voice measurements and machine learning
        </p>
    </div>
</section>

<div class="container">
    <!-- Section A: Disease Overview -->
    <div class="disease-overview">
        <h2>
            <i class="fas fa-info-circle" style="color: var(--primary-light);"></i>
            About Parkinson's Disease
        </h2>
        <p>
            Parkinson's disease is a progressive neurological disorder affecting movement and motor control. It occurs when
            nerve cells in the brain that produce dopamine become impaired or die, leading to tremors, stiffness, and difficulty
            with balance and coordination. Voice changes are among the early indicators, as the disease affects the muscles
            controlling speech. Research shows that vocal biomarkers can detect Parkinson's with high accuracy, enabling
            early intervention when treatments are most effective.
        </p>
    </div>

    <!-- Section B: Feature Explanations -->
    <div class="feature-explanations">
        <h3>
            <i class="fas fa-clipboard-list me-2"></i>
            Understanding Voice Biomarkers
        </h3>
        <p class="text-secondary mb-4">
            These voice measurements are used to detect subtle changes in vocal patterns associated with Parkinson's:
        </p>

        <div class="row">
            <div class="col-lg-4">
                <h5 class="mb-3"><i class="fas fa-wave-square me-2" style="color: var(--primary-light);"></i>Frequency Parameters</h5>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-microphone"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:Fo (Hz)</div>
                        <p class="feature-description">Average vocal fundamental frequency - the base pitch of your voice.</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-arrow-up"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:Fhi (Hz)</div>
                        <p class="feature-description">Maximum vocal fundamental frequency - highest pitch achieved.</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-arrow-down"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:Flo (Hz)</div>
                        <p class="feature-description">Minimum vocal fundamental frequency - lowest pitch achieved.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <h5 class="mb-3"><i class="fas fa-random me-2" style="color: var(--primary-light);"></i>Jitter (Frequency Variation)</h5>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-chart-area"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:Jitter (%)</div>
                        <p class="feature-description">Percentage of cycle-to-cycle frequency variation in voice.</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-ruler-horizontal"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:RAP, PPQ, DDP</div>
                        <p class="feature-description">Various measures of short-term frequency perturbation.</p>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <h5 class="mb-3"><i class="fas fa-volume-up me-2" style="color: var(--primary-light);"></i>Shimmer (Amplitude Variation)</h5>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-signal"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">MDVP:Shimmer</div>
                        <p class="feature-description">Variation in voice amplitude (loudness) between cycles.</p>
                    </div>
                </div>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-sliders-h"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">APQ3, APQ5, DDA</div>
                        <p class="feature-description">Amplitude perturbation quotients measuring voice stability.</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mt-4">
            <div class="col-lg-6">
                <h5 class="mb-3"><i class="fas fa-volume-off me-2" style="color: var(--primary-light);"></i>Noise Ratios</h5>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-adjust"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">NHR & HNR</div>
                        <p class="feature-description">Noise-to-harmonics and harmonics-to-noise ratios indicate voice quality and breathiness.</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <h5 class="mb-3"><i class="fas fa-project-diagram me-2" style="color: var(--primary-light);"></i>Nonlinear Dynamics</h5>
                <div class="feature-item">
                    <div class="feature-icon"><i class="fas fa-bezier-curve"></i></div>
                    <div class="feature-content">
                        <div class="feature-name">RPDE, DFA, D2, PPE</div>
                        <p class="feature-description">Complex measures capturing subtle irregularities in vocal cord vibration patterns.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section C: Prediction Form -->
    <div class="prediction-form">
        <h3>
            <i class="fas fa-edit me-2"></i>
            Enter Voice Measurement Parameters
        </h3>
        <p class="text-secondary mb-4">
            Note: These values typically come from voice analysis software. Default values represent typical healthy ranges.
        </p>

        <form asp-action="Index" method="post">
            @Html.AntiForgeryToken()

            <h5 class="mb-3"><i class="fas fa-wave-square me-2"></i>Frequency Parameters</h5>
            <div class="form-grid mb-4">
                <div class="form-group">
                    <label asp-for="Input.MDVP_Fo" class="form-label">MDVP:Fo <span class="unit">(Hz)</span></label>
                    <input asp-for="Input.MDVP_Fo" class="form-control" type="number" step="0.001" />
                    <small class="form-text">Average vocal frequency (typical: 80-260 Hz)</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_Fhi" class="form-label">MDVP:Fhi <span class="unit">(Hz)</span></label>
                    <input asp-for="Input.MDVP_Fhi" class="form-control" type="number" step="0.001" />
                    <small class="form-text">Maximum vocal frequency</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_Flo" class="form-label">MDVP:Flo <span class="unit">(Hz)</span></label>
                    <input asp-for="Input.MDVP_Flo" class="form-control" type="number" step="0.001" />
                    <small class="form-text">Minimum vocal frequency</small>
                </div>
            </div>

            <h5 class="mb-3"><i class="fas fa-random me-2"></i>Jitter Measurements</h5>
            <div class="form-grid mb-4">
                <div class="form-group">
                    <label asp-for="Input.MDVP_Jitter_Percent" class="form-label">MDVP:Jitter <span class="unit">(%)</span></label>
                    <input asp-for="Input.MDVP_Jitter_Percent" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_Jitter_Abs" class="form-label">MDVP:Jitter <span class="unit">(Abs)</span></label>
                    <input asp-for="Input.MDVP_Jitter_Abs" class="form-control" type="number" step="0.000001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_RAP" class="form-label">MDVP:RAP</label>
                    <input asp-for="Input.MDVP_RAP" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_PPQ" class="form-label">MDVP:PPQ</label>
                    <input asp-for="Input.MDVP_PPQ" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.Jitter_DDP" class="form-label">Jitter:DDP</label>
                    <input asp-for="Input.Jitter_DDP" class="form-control" type="number" step="0.00001" />
                </div>
            </div>

            <h5 class="mb-3"><i class="fas fa-volume-up me-2"></i>Shimmer Measurements</h5>
            <div class="form-grid mb-4">
                <div class="form-group">
                    <label asp-for="Input.MDVP_Shimmer" class="form-label">MDVP:Shimmer</label>
                    <input asp-for="Input.MDVP_Shimmer" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_Shimmer_dB" class="form-label">MDVP:Shimmer <span class="unit">(dB)</span></label>
                    <input asp-for="Input.MDVP_Shimmer_dB" class="form-control" type="number" step="0.001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.Shimmer_APQ3" class="form-label">Shimmer:APQ3</label>
                    <input asp-for="Input.Shimmer_APQ3" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.Shimmer_APQ5" class="form-label">Shimmer:APQ5</label>
                    <input asp-for="Input.Shimmer_APQ5" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.MDVP_APQ" class="form-label">MDVP:APQ</label>
                    <input asp-for="Input.MDVP_APQ" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.Shimmer_DDA" class="form-label">Shimmer:DDA</label>
                    <input asp-for="Input.Shimmer_DDA" class="form-control" type="number" step="0.00001" />
                </div>
            </div>

            <h5 class="mb-3"><i class="fas fa-adjust me-2"></i>Noise & Nonlinear Parameters</h5>
            <div class="form-grid mb-4">
                <div class="form-group">
                    <label asp-for="Input.NHR" class="form-label">NHR</label>
                    <input asp-for="Input.NHR" class="form-control" type="number" step="0.00001" />
                    <small class="form-text">Noise-to-harmonics ratio</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.HNR" class="form-label">HNR</label>
                    <input asp-for="Input.HNR" class="form-control" type="number" step="0.001" />
                    <small class="form-text">Harmonics-to-noise ratio</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.RPDE" class="form-label">RPDE</label>
                    <input asp-for="Input.RPDE" class="form-control" type="number" step="0.00001" />
                    <small class="form-text">Recurrence period density entropy</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.DFA" class="form-label">DFA</label>
                    <input asp-for="Input.DFA" class="form-control" type="number" step="0.00001" />
                    <small class="form-text">Detrended fluctuation analysis</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.Spread1" class="form-label">Spread1</label>
                    <input asp-for="Input.Spread1" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.Spread2" class="form-label">Spread2</label>
                    <input asp-for="Input.Spread2" class="form-control" type="number" step="0.00001" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.D2" class="form-label">D2</label>
                    <input asp-for="Input.D2" class="form-control" type="number" step="0.00001" />
                    <small class="form-text">Correlation dimension</small>
                </div>
                <div class="form-group">
                    <label asp-for="Input.PPE" class="form-label">PPE</label>
                    <input asp-for="Input.PPE" class="form-control" type="number" step="0.00001" />
                    <small class="form-text">Pitch period entropy</small>
                </div>
            </div>

            <div class="text-center mt-4">
                <button type="submit" class="btn-predict">
                    <i class="fas fa-brain"></i>
                    Analyze Voice Patterns
                </button>
            </div>
        </form>

        <!-- Result Display -->
        @if (Model.Result != null)
        {
            <div class="result-card @(Model.Result.Success ? (Model.Result.Prediction == 1 ? "positive" : "negative") : "error")">
                @if (Model.Result.Success)
                {
                    <div class="result-header">
                        <div class="result-icon">
                            @if (Model.Result.Prediction == 1)
                            {
                                <i class="fas fa-exclamation-triangle"></i>
                            }
                            else
                            {
                                <i class="fas fa-check-circle"></i>
                            }
                        </div>
                        <div>
                            <h3 class="result-title">
                                @(Model.Result.Prediction == 1 ? "Parkinson's Indicators Detected" : "No Parkinson's Indicators")
                            </h3>
                            <span class="risk-badge @Model.Result.RiskLevel.ToLower()">
                                @Model.Result.RiskLevel Risk
                            </span>
                        </div>
                    </div>

                    <p>@Model.Result.Message</p>

                    <div class="result-details">
                        <div class="result-metric">
                            <div class="result-metric-label">Confidence</div>
                            <div class="result-metric-value">
                                @if (Model.Result.Prediction == 0)
                                {
                                    @((100 - Model.Result.Probability).ToString("F1"))@:%
                                }
                                else
                                {
                                    @Model.Result.Probability.ToString("F1")@:%
                                }
                            </div>
                        </div>
                        <div class="result-metric">
                            <div class="result-metric-label">Risk Level</div>
                            <div class="result-metric-value">@Model.Result.RiskLevel</div>
                        </div>
                        <div class="result-metric">
                            <div class="result-metric-label">Assessment</div>
                            <div class="result-metric-value">Neurological</div>
                        </div>
                    </div>
                }
                else
                {
                    <div class="result-header">
                        <div class="result-icon" style="background: var(--warning-yellow);">
                            <i class="fas fa-exclamation-circle"></i>
                        </div>
                        <div>
                            <h3 class="result-title" style="color: var(--warning-yellow);">Analysis Error</h3>
                        </div>
                    </div>
                    <p>@Model.Result.Error</p>
                }
            </div>
        }
    </div>

    <!-- Medical Disclaimer -->
    <div class="medical-disclaimer">
        <div class="medical-disclaimer-title">
            <i class="fas fa-exclamation-triangle"></i>
            Medical Disclaimer
        </div>
        <p>
            This Parkinson's screening provides informational insights only and is <strong>not a medical diagnosis</strong>.
            The analysis uses voice biomarkers from the UCI Parkinson's Dataset. Please consult a neurologist for proper
            evaluation of any movement disorders or neurological concerns.
        </p>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
